#!/bin/bash

# Speichere alle URLs der pihole adlists in einem Array
adlists=($(pihole -g | grep "url" | cut -d "=" -f 2))

# Iteriere über alle adlists
for adlist in "${adlists[@]}"; do
    # Speichere die Domains der aktuellen adlist in einem Array
    domains=($(curl -s $adlist | grep -oP "^[^#]*" | awk '{print $2}'))

    # Iteriere über alle anderen adlists
    for compare_adlist in "${adlists[@]}"; do
        # Überspringe die aktuelle adlist
        if [[ $adlist == $compare_adlist ]]; then
            continue
        fi

        # Speichere die Domains der zu vergleichenden adlist in einem Array
        compare_domains=($(curl -s $compare_adlist | grep -oP "^[^#]*" | awk '{print $2}'))

        # Prüfe, ob die Domains der aktuellen adlist in der zu vergleichenden vorkommen
        unique=true
        for domain in "${domains[@]}"; do
            if grep -q $domain <<< "${compare_domains[@]}"; then
                unique=false
                break
            fi
        done

        # Wenn die Domains der aktuellen adlist nicht in der zu vergleichenden vorkommen, gehe zur nächsten adlist
        if $unique; then
            continue
        fi

        # Wenn die Domains der aktuellen adlist in der zu vergleichenden vorkommen, gib die adlist aus
        echo $adlist
    done
done
